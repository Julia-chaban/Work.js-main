<!DOCTYPE html>
<html>
  <head>
    <title>Проект "Комменты"</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="styles.css" />
  </head>

  <body>
    <div class="container">
      <ul class="comments"></ul>
      <form class="add-form">
        <label for="autor">Автор</label>
        <input type="text" id="autor" class="add-form-name" placeholder="Введите ваше имя">
        <label for="comment">Комментарий:</label>
        <textarea id="comment" class="add-form-text" placeholder="Введите ваш комментарий" rows="4"></textarea>
        <button class="add-form-button">Отправить</button>
      </form>
    </div>
          
  <script>
   "use strict";
   
       const commentsData = [
        {
          name: "Глеб Фокин",
          text: "Это будет первый комментарий на этой странице",
          liked: false,
          likesCount: 3,
          createdAt: "12.02.22 12:18",
        },
        {
          name: "Варвара Н.",
          text: "Мне нравится как оформлена эта страница! ❤️",
          liked: true,
          likesCount: 75,
          createdAt: "13.02.22 19:22",
        },
      ];

        function renderComments(comments) {
        const commentsList = document.querySelector('.comments');
        commentsList.innerHTML = ""; 

        comments.forEach(comment => {
          const template = `
            <li class="comment">
              <div class="comment-header">
                <div>${comment.name}</div>
                <div>${comment.createdAt}</div>
              </div>
              <div class="comment-body">
                <div class="comment-text">${comment.text}</div>
              </div>
              <div class="comment-footer">
                <div class="likes">
                  <span class="likes-counter">${comment.likesCount}</span>
                  <button class="like-button ${comment.liked ? 'active' : ""}" data-id="${comments.indexOf(comment)}">❤️</button>
                </div>
              </div>
            </li>
          `;
          commentsList.innerHTML += template;
        });
      }
      renderComments(commentsData);

      document.querySelector(`.comments`).addEventListener("click", (event) => {
        if(event.target.classList.contains("like-button")) {
        const commentId = event.target.dataset.id;
        const comment = commentsData[commentId];
       
       comment.liked = !comment.liked;
        if (comment.liked) {
          comment.likesCount ++;
        } else {
          comment.likesCount --;
        }
        renderComments(commentsData);
      }
    });
    document.querySelector(`.add-form`).addEventListener("submit" , (event) => {
      event.preventDefault();
      const name = document.querySelector(`.add-form-name`).value.trim();
      const text = document.querySelector(`.add-form-text`).value.trim();
      if (!name || !text) {
        alert("Заполните поля");
        return;
      }
      
      const newComment = {
        name,
        text,
        liked:false,
        likesCount:0,
        createdAt: new Date().toLocaleString(),
      };
      commentsData.push(newComment);
      renderComments(commentsData);

      document.querySelector(`.add-form-name`).value = "";
      document.querySelector(`.add-form-text`).value = "";
    });
    
  </script>
  </body>
</html>
